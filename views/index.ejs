<!DOCTYPE html>
<head>
<script src="http://code.jquery.com/jquery-2.1.0.min.js" type="text/javascript"></script>
<script src="http://autobahn.s3.amazonaws.com/js/autobahn.min.js" type="text/javascript"></script>
<script type="text/javascript">
$(document).ready(function() {
	console.log("We're ready!");
	window.abSession = null;

	if (!ab) {
		throw new Error("Autobahn has not been included!");
	}

	ab.connect('ws://localhost:8080', function(session) {
		console.log("We're connected with WAMP");
		window.abSession = session;
	}, function(code, reason, detail) {
		console.log("Got error code:");
		console.log(code);

		console.log("Details:");
		console.log(detail);
	},
	{
		maxRetries: 60,
		retryDelay, 2000
	});
});
</script>
</head>
<body>
<% if (!user) { %>
	<h2>Welcome! Please log in.</h2>
	<p>
	<a href="/">Home</a> | 
	<a href="/auth/twitchtv">Log In</a>
	</p>
<% } else { %>
	<h2>Hello, <%= user.username %>, welcome to Coup de Twitch!</h2>
	<input style="display: block" id="directText" type="text" />
	<button id="directCmd">Send to Twitch's chat</button>
	<input style="display: block" id="commandText" type="text" />
	<button id="register">Register this command on next tick</button>
<% } %>
</body>